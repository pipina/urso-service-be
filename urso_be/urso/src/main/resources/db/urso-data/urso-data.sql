create schema csru_set;

create table csru_set.set_dlznici_refresh
(
    id               integer generated by default as identity
        constraint set_dlznici_refresh_pk
            primary key,
    date_refresh     timestamp default now() not null,
    source           smallint                not null,
    records_modified integer                 not null
);

create table csru_set.set_dlznici
(
    id           integer generated by default as identity
        constraint set_dlznici_pk
            primary key,
    nazov        varchar not null,
    ico          varchar not null,
    id_po        integer,
    id_refreshed integer
        constraint set_dlznici_refresh_fk
            references csru_set.set_dlznici_refresh
);

create table csru_set.set_dlznici_obdobie
(
    id         integer generated by default as identity
        constraint set_dlznici_obdobie_pk
            primary key,
    id_dlznici integer not null
        constraint set_dlznici_obdobie_fk
            references csru_set.set_dlznici,
    obdobie_od date,
    obdobie_do date,
    zdroj      smallint
);

INSERT INTO csru_set.set_dlznici_refresh (id, date_refresh, source, records_modified) VALUES (3, '2023-11-16 15:00:00.000000', 2, 3);
INSERT INTO csru_set.set_dlznici_refresh (id, date_refresh, source, records_modified) VALUES (2, '2023-10-27 17:43:21.000000', 2, 1);
INSERT INTO csru_set.set_dlznici_refresh (id, date_refresh, source, records_modified) VALUES (1, '2023-10-10 01:00:00.000000', 1, 18);

INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (2, 'TEPLÁREŇ Považská Bystrica, s.r.o.', '36300683', 293, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (3, 'Bytkomfort, s.r.o.', '36555193', 258, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (4, 'Bytový podnik Myjava spol. s r.o.', '31445918', 758, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (6, 'U. S. Steel Košice, s.r.o.', '36199222', 305, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (7, 'BUČINA ZVOLEN, a.s.', '36029815', 310, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (8, 'BUKOCEL, a.s.', '36445461', 268, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (9, 'Tate & Lyle Boleraz, s.r.o.', '31411011', 382, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (10, 'Slovenské elektrárne, a.s.', '35829052', 340, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (11, 'STEFE Banská Bystrica, a.s.', '36024473', 311, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (13, 'Duslo, a.s.', '35826487', 341, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (14, 'SLUŽBYT, s.r.o.', '31675361', 368, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (15, 'Železiarne Podbrezová a.s. skrátene ŽP a.s.', '31562141', 380, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (16, 'SLOVENSKÉ CUKROVARY, s.r.o.', '31568386', 379, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (17, 'SLOVNAFT, a.s.', '31322832', 392, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (18, 'ENSTRA Power Generation LC s.r.o.', '36043427', 308, 1);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (1, 'Veolia Energia Levice, a.s.', '35968486', 321, 3);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (5, 'MH Teplárenský holding, a.s.', '36211541', 302, 3);
INSERT INTO csru_set.set_dlznici (id, nazov, ico, id_po, id_refreshed) VALUES (12, 'PRAVEL, spol. s r.o.', '36194832', 306, 2);

INSERT INTO csru_set.set_dlznici_obdobie (id, id_dlznici, obdobie_od, obdobie_do, zdroj) VALUES (1, 1, '2023-11-01', null, 1);
INSERT INTO csru_set.set_dlznici_obdobie (id, id_dlznici, obdobie_od, obdobie_do, zdroj) VALUES (2, 5, '2023-08-23', '2023-10-30', 2);
INSERT INTO csru_set.set_dlznici_obdobie (id, id_dlznici, obdobie_od, obdobie_do, zdroj) VALUES (3, 12, '2023-10-10', '2023-10-21', 3);
INSERT INTO csru_set.set_dlznici_obdobie (id, id_dlznici, obdobie_od, obdobie_do, zdroj) VALUES (4, 12, '2023-11-01', null, 3);

SELECT setval('csru_set.set_dlznici_obdobie_id_seq', (SELECT max(id) + 1 FROM csru_set.set_dlznici_obdobie));